{% extends 'accounts/base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<style>
	body, html {
		height: 100%;
		margin: 0;
	}

	.dashboard {
		display: flex;
		height: 100vh;
	}

	/* Sidebar */
	.sidebar {
		width: 250px;
		background-color: #343a40;
		color: #fff;
		padding: 20px;
	}
	.sidebar h4 {
		color: #f8f9fa;
		margin-bottom: 20px;
	}
	.sidebar .nav-link {
		color: #adb5bd;
		padding: 8px 0;
		display: block;
		text-decoration: none;
	}
	.sidebar .nav-link.active,
	.sidebar .nav-link:hover {
		color: #fff;
		font-weight: bold;
	}

	/* Main content */
	.main-content {
		flex-grow: 1;
		padding: 30px;
		background-color: #f1f3f6;
		overflow-y: auto;
	}
	.module-card {
		background: #fff;
		border-radius: 10px;
		padding: 20px;
		box-shadow: 0 2px 5px rgba(0,0,0,0.1);
		margin-bottom: 20px;
	}
</style>

<div class="dashboard">
	<!-- Sidebar -->
	<div class="sidebar">
		<h4>Dashboard</h4>
		<ul class="nav flex-column" id="moduleTabs">
			<li><a class="nav-link active" href="#" data-target="concession">Apply for Concession</a></li>
			<li><a class="nav-link" href="#" data-target="pass">Apply for Pass</a></li>
			<li><a class="nav-link" href="#" data-target="current">Current Pass</a></li>
			<li><a class="nav-link" href="#" data-target="concessions">No. of Concessions Taken</a></li>
		</ul>
	</div>

	<!-- Main content -->
	<div class="main-content">
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h2>Welcome, {{ user.username }} ðŸ‘‹</h2>
			<a href="{% url 'logout' %}" class="btn btn-danger btn-sm">Logout</a>
		</div>

		<div id="moduleContent">
			<div class="module module-card" id="concession">
				<h4 class="text-center">Apply for Concession</h4>
				<!-- Include the separate form template -->
    			{% include 'concession_form.html' %}
			</div>

			<div class="module module-card d-none" id="pass">
				<h4>Apply for Pass</h4>
				<p>Instructions or form goes here.</p>
			</div>

			<div class="module module-card" id="current">
				<h4>Current Pass</h4>
				<a href="{% url 'show_pass' %}" class="btn btn-success">View My E-Pass</a>
			</div>
			
			<div class="module module-card d-none" id="concessions">
				<h4>No. of Concessions Taken</h4>
				<p>Total concessions taken: {{ concessions_taken }}</p>
			</div>
		</div>
	</div>
</div>

<script>
	const links = document.querySelectorAll('#moduleTabs .nav-link');
	const modules = document.querySelectorAll('#moduleContent .module');

	links.forEach(link => {
		link.addEventListener('click', function(e) {
			e.preventDefault();
			links.forEach(l => l.classList.remove('active'));
			this.classList.add('active');

			modules.forEach(m => m.classList.add('d-none'));
			const target = this.dataset.target;
			document.getElementById(target).classList.remove('d-none');
		});
	});

	
</script>
{% endblock %}
